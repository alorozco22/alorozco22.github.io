var ebMCQsInit=function(){return-1===navigator.userAgent.indexOf("Opera Mini")&&"querySelector"in document&&!!Array.prototype.forEach&&"addEventListener"in window&&document.querySelectorAll(".question")},ebMCQsFindNumberOfCorrectAnswers=function(e){var t=/\D/;return e.match(t).index},ebMCQsPositionOfCorrectAnswer=function(e){var t=/[aeiou]*/;return e.match(t)[0].length},ebMCQsDobfuscateQuestionCode=function(e){for(var t=ebMCQsFindNumberOfCorrectAnswers(e),r=e.length,n=e.substr(t,r),o=[],c=0;c<t;c++){var s=ebMCQsPositionOfCorrectAnswer(n);o.push(s),n=n.substr(2*s,n.length)}return o},ebMCQsGetCorrectAnswers=function(e){var t=e.getAttribute("data-question-code"),r=ebMCQsDobfuscateQuestionCode(t),n={};return e.querySelectorAll(".mcq-feedback li").forEach(function(e,t){n[t+1]=!1}),r.forEach(function(e){n[e]=!0}),n},ebMCQsMakeOptionCheckboxes=function(e){e.querySelectorAll(".mcq-options li").forEach(function(e,t){var r=document.createElement("input");r.setAttribute("type","checkbox"),r.setAttribute("data-index",t),e.innerHTML="<label>"+r.outerHTML+e.innerHTML+"</label>"})},ebMCQsAddButton=function(e){var t=document.createElement("button");t.innerHTML=locales[pageLanguage].questions["check-answers-button"],t.classList.add("check-answer-button");var r=e.querySelector(".mcq-feedback");e.insertBefore(t,r)},ebMCQsGetAllSelected=function(e){var t={};return e.querySelectorAll('[type="checkbox"]').forEach(function(e,r){t[r+1]=!1}),e.querySelectorAll('[type="checkbox"]:checked').forEach(function(e){var r=parseFloat(e.getAttribute("data-index"));t[r+1]=!0}),t},ebMCQsHideAllFeedback=function(e){e.querySelectorAll(".mcq-feedback li").forEach(function(e){e.classList.remove("mcq-feedback-show")})},ebMCQsShowSelectedOptions=function(e,t){e.querySelectorAll(".mcq-feedback li").forEach(function(e,r){t[r+1]&&e.classList.add("mcq-feedback-show")})},ebMCQsShowSelectedIncorrectOptions=function(e,t,r){e.querySelectorAll(".mcq-feedback li").forEach(function(e,n){t[n+1]&&t[n+1]!==r[n+1]&&e.classList.add("mcq-feedback-show")})},ebMCQsMarkSelectedOptions=function(){document.querySelectorAll(".mcq-options li").forEach(function(e){e.addEventListener("click",function(){this.querySelector('[type="checkbox"]:checked')?this.classList.add("selected"):this.classList.remove("selected")})})},ebMCQsGetAllCorrectAnswers=function(){var e={};return document.querySelectorAll(".question").forEach(function(t){var r=ebMCQsGetCorrectAnswers(t),n=t.getAttribute("data-question");e[n]=r}),e},ebMCQsExactlyRight=function(e,t){for(var r in t)if(t[r]!==e[r])return!1;return!0},ebMCQsNotAllTheCorrectAnswers=function(e,t){var r=0,n=0,o=0;for(var c in e)e[c]&&r++,e[c]&&t[c]&&n++,!e[c]&&t[c]&&o++;return n<r&&0===o},ebMCQsWordPressUserId=function(){var e=document.cookie.split("; "),t=e.find(function(e){return 0===e.indexOf("coreproject_sess")});return!!t&&decodeURIComponent(t).replace("coreproject_sess=","")},ebMCQsAddWordPressAccountButton=function(){var e=document.querySelector("#nav");if(e){var t=e.querySelector("h2"),r=document.createElement("a");r.innerText="Log in",r.href="/login/",r.classList.add("wordpress-link"),e.insertBefore(r,t),ebMCQsWordPressUserId()&&(r.innerText="My account",r.href="/account/")}},ebMCQsSendtoWordPress=function(e,t){var r=ebMCQsWordPressUserId();if(ebMCQsWordPressUserId()){var n={action:"quiz_score",book_id:1,quiz_id:e,user_id:r,score:t},o=[];for(var c in n)o.push(encodeURIComponent(c)+"="+encodeURIComponent(n[c]));var s=o.join("&"),i=new XMLHttpRequest;i.open("POST","/wp-admin/admin-ajax.php",!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.send(s)}},ebMCQsButtonClicks=function(){document.querySelectorAll(".check-answer-button").forEach(function(e){e.addEventListener("click",function(){var e=this.parentNode,t=e.getAttribute("data-question");e.getAttribute("data-question-code"),ebMCQsHideAllFeedback(e);var r=ebMCQsGetAllSelected(e),n=ebMCQsGetAllCorrectAnswers(),o=n[t];e.classList.remove("mcq-incorrect"),e.classList.remove("mcq-partially-correct"),e.classList.remove("mcq-correct");var c=0;ebMCQsExactlyRight(o,r)?(e.classList.add("mcq-correct"),ebMCQsShowSelectedOptions(e,r),c=1):ebMCQsNotAllTheCorrectAnswers(o,r)?(e.classList.add("mcq-partially-correct"),ebMCQsShowSelectedIncorrectOptions(e,r,o)):(e.classList.add("mcq-incorrect"),ebMCQsShowSelectedIncorrectOptions(e,r,o));var s=t.replace("question-","");ebMCQsSendtoWordPress(s,c)})})},ebMCQs=function(){if(ebMCQsInit()){ebMCQsAddWordPressAccountButton(),document.documentElement.classList.add("js-mcq");document.querySelectorAll(".question").forEach(function(e){ebMCQsMakeOptionCheckboxes(e),ebMCQsAddButton(e)}),ebMCQsMarkSelectedOptions(),ebMCQsButtonClicks()}};ebMCQs();