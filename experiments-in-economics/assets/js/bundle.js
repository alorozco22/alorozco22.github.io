"function"!=typeof NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),function(){function t(t){this.el=t;for(var e=t.className.replace(/^\s+|\s+$/g,"").split(/\s+/),i=0;i<e.length;i++)n.call(this,e[i])}if(!(void 0===window.Element||"classList"in document.documentElement)){var e=Array.prototype,n=e.push,i=e.splice,o=e.join;t.prototype={add:function(t){this.contains(t)||(n.call(this,t),this.el.className=this.toString())},contains:function(t){return-1!=this.el.className.indexOf(t)},item:function(t){return this[t]||null},remove:function(t){if(this.contains(t)){for(var e=0;e<this.length&&this[e]!=t;e++);i.call(this,e,1),this.el.className=this.toString()}},toString:function(){return o.call(this," ")},toggle:function(t){return this.contains(t)?this.remove(t):this.add(t),this.contains(t)}},window.DOMTokenList=t,function(t,e,n){Object.defineProperty?Object.defineProperty(t,e,{get:n}):t.__defineGetter__(e,n)}(Element.prototype,"classList",function(){return new t(this)})}}(),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var i=arguments[1],o=0;o<n;){var r=e[o];if(t.call(i,r,o,e))return r;o++}}});
// Load locales.yml into a locales array.

// Convert locales.yml into a JSON string.
// Note that hyphens in keys are converted to underscores.
var locales = {"en":{"iso-name":"English","local-name":"English","project":{"organisation":"","url":"","email":"","name":"Experiments in economics: Laboratory projects","creator":"Universidad de los Andes CORE Team","description":"","image":"","credit":""},"nav":{"home":"Home","menu":"Contents","next":"Next","previous":"Previous","back":"←"},"home":{"read":"Read"},"input":{"submit":"Submit","send":"Send"},"search":{"placeholder":"Search","search-title":"Search","placeholder-searching":"Searching...","notice":"","search-results":"Search results","results-for-singular":"result found for","results-for-plural":"results found for","results-for-none":"No results found for","jump-to-first":"Jump to first result ↓"},"contact":{"placeholder":{"name":"Name","email":"Email address","message":"Message"}},"questions":{"check-answers-button":"Check my answers","feedback-correct":"Correct!","feedback-incorrect":"Incorrect","feedback-unfinished":"You haven't selected all the correct answers."},"themes":{"legend-heading":"Themes and capstone units"},"beta":{"label":"Beta","message":"This book is a beta edition. It is in development, and we need your input to improve it. [Please send us feedback here](http://www.core-econ.org/contact-us/).","link":"http://www.core-econ.org/contact-us/"}},"fr":{"iso-name":"French","local-name":"Français","project":{"organisation":"","url":"","email":"","name":"","creator":"L'équipe CORE","description":"Livres créés avec le flux de travail Electric Book","image":"","credit":"Construit avec [l'Electric Book](http://electricbook.works)"},"nav":{"home":"Accueil","menu":"Table des matières","next":"Suivant","previous":"Précédent","back":"←"},"home":{"read":"Lire"},"input":{"submit":"Soumettre","send":"Envoyer"},"search":{"placeholder":"Recherche","search-title":"Recherche","placeholder-searching":"Recherche...","notice":"Les résultats de recherche en français seront disponibles prochainement.","search-results":"Résultats de la recherche","results-for-singular":"résultat trouvé pour","results-for-plural":"résultats trouvés pour","results-for-none":"Aucun résultat trouvé pour","jump-to-first":"Aller au premier résultat ↓"},"contact":{"placeholder":{"name":"Nom","email":"L’adresse e-mail","message":"Message"}},"questions":{"check-answers-button":"Vérifiez mes réponses","feedback-correct":"Correct!","feedback-incorrect":"Incorrect","feedback-unfinished":"Vous n'avez pas sélectionné toutes les bonnes réponses."},"themes":{"legend-heading":"Themes and capstone units"},"beta":{"label":"Beta","message":"This book is a beta edition. It is in development, and we need your input to improve it. [Please send us feedback here](http://www.core-econ.org/contact-us/).","link":"http://www.core-econ.org/contact-us/"}}};

// Or get the language from a URL parameter
// https://stackoverflow.com/a/901144/1781075
function getParameterByName(name, url) {
    if (!url) url = window.location.href;
    name = name.replace(/[\[\]]/g, "\\$&");
    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
        results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return '';
    return decodeURIComponent(results[2].replace(/\+/g, " "));
}

// Various content localisations

function localiseText() {

    // Localise home page
    var homeReadbuttons = document.querySelectorAll('.button');
    var homePageHeading = document.querySelector('.home h1');
    // If language is set with a URL param, show only that language's read button
    if (homeReadbuttons.length > 0 && pageLanguageByURLParameter) {
        for (let i = 0; i < homeReadbuttons.length; i++) {
            homeReadbuttons[i].classList.add('visuallyhidden');
        }
        var languageButton = document.createElement('p');
        languageButton.classList.add('button');
        homePageHeading.insertAdjacentElement('afterend', languageButton);
        if (pageLanguage == 'en') {
            languageButton.innerHTML = '<a href="book/text/0-3-contents.html">' + locales[pageLanguage].home.read + '</a>';
        } else {
            languageButton.innerHTML = '<a href="book/' + pageLanguage + '/text/0-3-contents.html">' + locales[pageLanguage].home.read + '</a>';
        }
    }

    // Localise author and title on home page
    var homePageTitle = document.querySelector('.home h1');
    if (homePageTitle) {
        homePageTitle.innerHTML = '<strong>' + locales[pageLanguage].project.creator + '</strong>' + locales[pageLanguage].project.name;
    }

    // Localise masthead
    var mastheadProjectName = document.querySelector('.masthead .masthead-series-name a');
    if (mastheadProjectName) {
        mastheadProjectName.innerHTML = locales[pageLanguage].project.name;
    }

    // Localise search
    var searchPageHeading = document.querySelector('.search-page #content h1:first-of-type');
    if (searchPageHeading) {
        searchPageHeading.innerHTML = locales[pageLanguage].search['search-title'];
    }

    // Localise search form
    var searchLanguageToLocalise = document.querySelector('#search-language');
    if (searchLanguageToLocalise) {
        searchLanguageToLocalise.setAttribute('value', pageLanguage);
    };

    // Localise search-box placeholder
    var searchInputBox = document.querySelector('.search input.search-box');
    if (searchInputBox) {
        var searchInputBoxPlaceholder = document.querySelector('.search input.search-box').placeholder;
        if (searchInputBoxPlaceholder) {
            searchInputBoxPlaceholder = locales[pageLanguage].search['search-placeholder'];
        }
    }

    // Localise searching... notice
    var searchProgressPlaceholder = document.querySelector('.search-placeholder');
    if (searchProgressPlaceholder) {
        searchProgressPlaceholder.innerHTML = locales[pageLanguage].search['placeholder-searching'];
    };

    // Localise Google CSE search snippets
    var googleCSESearchBox = document.querySelector('.search input.search-box');
    if (googleCSESearchBox) {
        googleCSESearchBox.placeholder = locales[pageLanguage].search.placeholder;
    };

    // Add any notices set in locales as search.notice
    if (searchPageHeading) {
        var searchNotice = document.createElement('div');
        searchNotice.classList.add('search-page-notice');
        searchNotice.innerHTML = '<p>' + locales[pageLanguage].search.notice + '</p>';
        searchPageHeading.insertAdjacentElement('afterend', searchNotice);
    };

    // We cannot localise the nav/TOC, since the root search page
    // always uses the parent-language. So we replace the nav
    // on the search page with a back button instead.
    // In case we have a back button (`$nav-bar-back-button-hide; true` in scss)
    // hide that one.
    var searchNavButtonToReplace = document.querySelector('.search-page [href="#nav"]');
    var searchNavDivToReplace = document.querySelector('.search-page #nav');
    var navBackButton = document.querySelector('.nav-back-button');
    if (searchNavButtonToReplace && navBackButton) {
        if (document.referrer != "" || window.history.length > 0) {
            navBackButton.remove();
            searchNavButtonToReplace.innerHTML = locales[pageLanguage].nav.back;
            searchNavButtonToReplace.addEventListener('click', function(ev) {
                ev.preventDefault();
                console.log('Going back...');
                window.history.back();
            });
        };
    };
    if (searchNavDivToReplace) {
        searchNavDivToReplace.innerHTML = '';
    }

    // If no results with GSE, translate 'No results' phrase
    window.addEventListener("load", function (event) {
        console.log("All loaded, checking for no-result.");
        var noResultsGSE = document.querySelector('.gs-no-results-result .gs-snippet');
        if (noResultsGSE) {
            noResultsGSE.innerHTML = locales[pageLanguage].search['results-for-none'] + ' ‘' + searchTerm + '’';
        }
    });

    // localise questions
    var questionButtons = document.querySelectorAll('.question .check-answer-button');
    function replaceText(button) {
        button.innerHTML='';
    }
    if (questionButtons) {
        questionButtons.forEach(replaceText);
    }
}

// Get the page language
if (getParameterByName('lang')) {
    var pageLanguage = getParameterByName('lang');
    var pageLanguageByURLParameter = true;
    localiseText();
} else {
    var pageLanguage = document.documentElement.lang;
    // If epub, this is xml:lang
    if (!pageLanguage) {
        var pageLanguage = document.documentElement.getAttribute('xml:lang');
    }
    localiseText();
};

"use strict";function ebNav(){if(-1===navigator.userAgent.indexOf("Opera Mini")&&"querySelector"in document&&"addEventListener"in window){document.documentElement.classList.add("js-nav");var e=document.querySelector('[href="#nav"]'),t=document.querySelector("#nav");t.classList.add("visuallyhidden");var n="<button data-toggle data-nav-close>";n+='<span class="visuallyhidden">Close menu</span>',n+="</button>",t.insertAdjacentHTML("afterBegin",n);var a=document.querySelectorAll("#nav .has-children, #nav .has-children"),l="<button data-toggle data-toggle-nav>";l+='<span class="visuallyhidden">Toggle</span>',l+="</button>";for(var i=0;i<a.length;i++)a[i].querySelector("ol, ul").classList.add("visuallyhidden"),a[i].querySelector("a").insertAdjacentHTML("afterend",l);e.addEventListener("click",function(e){e.preventDefault(),t.classList.toggle("visuallyhidden"),document.documentElement.classList.toggle("js-nav-open")},!0);var s=function(){t.classList.add("visuallyhidden"),document.documentElement.classList.remove("js-nav-open")};if(t.addEventListener("click",function(e){var t=e.target||e.srcElement;return t.hasAttribute("data-nav-close")?(e.preventDefault(),void s()):t.hasAttribute("data-toggle-nav")?(e.preventDefault(),t.classList.toggle("show-children"),void t.nextElementSibling.classList.toggle("visuallyhidden")):"A"===t.tagName&&t.getAttribute("href")?void s():"A"===t.tagName?(t.nextElementSibling.classList.toggle("show-children"),void t.nextElementSibling.nextElementSibling.classList.toggle("visuallyhidden")):void 0}),""!=document.referrer||window.history.length>2){var d=document.querySelector("a.nav-back-button");d&&d.addEventListener("click",function(e){e.preventDefault(),window.history.back()})}else{var d=document.querySelector("a.nav-back-button");d&&d.parentNode.removeChild(d)}}}ebNav();
function ebGetQueryVariable(e){for(var r=window.location.search.substring(1),a=r.split("&"),t=0;t<a.length;t++){var o=a[t].split("=");if(o[0]===e)return decodeURIComponent(o[1].replace(/\+/g,"%20"))}}var searchTerm=ebGetQueryVariable("query"),searchBox=document.querySelectorAll(".search-box");if(searchTerm&&searchBox)for(var j=0;j<searchBox.length;++j)searchBox[j].setAttribute("value",searchTerm);
/*!***************************************************
 * mark.js v8.4.0
 * https://github.com/julmot/mark.js
 * Copyright (c) 2014–2016, Julian Motz
 * Released under the MIT license https://git.io/vwTVl
 *****************************************************/
"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _extends=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},_createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a};!function(a,b,c){"function"==typeof define&&define.amd?define([],function(){return a(b,c)}):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=a(b,c):a(b,c)}(function(a,b){var c=function(){function c(a){_classCallCheck(this,c),this.ctx=a}return _createClass(c,[{key:"log",value:function a(b){var c=arguments.length<=1||void 0===arguments[1]?"debug":arguments[1],a=this.opt.log;this.opt.debug&&"object"===("undefined"==typeof a?"undefined":_typeof(a))&&"function"==typeof a[c]&&a[c]("mark.js: "+b)}},{key:"escapeStr",value:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}},{key:"createRegExp",value:function(a){return a=this.escapeStr(a),Object.keys(this.opt.synonyms).length&&(a=this.createSynonymsRegExp(a)),this.opt.ignoreJoiners&&(a=this.setupIgnoreJoinersRegExp(a)),this.opt.diacritics&&(a=this.createDiacriticsRegExp(a)),a=this.createMergedBlanksRegExp(a),this.opt.ignoreJoiners&&(a=this.createIgnoreJoinersRegExp(a)),a=this.createAccuracyRegExp(a)}},{key:"createSynonymsRegExp",value:function(a){var b=this.opt.synonyms,c=this.opt.caseSensitive?"":"i";for(var d in b)if(b.hasOwnProperty(d)){var e=b[d],f=this.escapeStr(d),g=this.escapeStr(e);a=a.replace(new RegExp("("+f+"|"+g+")","gm"+c),"("+f+"|"+g+")")}return a}},{key:"setupIgnoreJoinersRegExp",value:function(a){return a.replace(/[^(|)]/g,function(a,b,c){var d=c.charAt(b+1);return/[(|)]/.test(d)||""===d?a:a+"\0"})}},{key:"createIgnoreJoinersRegExp",value:function(a){return a.split("\0").join("[\\u00ad|\\u200b|\\u200c|\\u200d]?")}},{key:"createDiacriticsRegExp",value:function(a){var b=this.opt.caseSensitive?"":"i",c=this.opt.caseSensitive?["aàáâãäåāąă","AÀÁÂÃÄÅĀĄĂ","cçćč","CÇĆČ","dđď","DĐĎ","eèéêëěēę","EÈÉÊËĚĒĘ","iìíîïī","IÌÍÎÏĪ","lł","LŁ","nñňń","NÑŇŃ","oòóôõöøō","OÒÓÔÕÖØŌ","rř","RŘ","sšśș","SŠŚȘ","tťț","TŤȚ","uùúûüůū","UÙÚÛÜŮŪ","yÿý","YŸÝ","zžżź","ZŽŻŹ"]:["aÀÁÂÃÄÅàáâãäåĀāąĄăĂ","cÇçćĆčČ","dđĐďĎ","eÈÉÊËèéêëěĚĒēęĘ","iÌÍÎÏìíîïĪī","lłŁ","nÑñňŇńŃ","oÒÓÔÕÖØòóôõöøŌō","rřŘ","sŠšśŚșȘ","tťŤțȚ","uÙÚÛÜùúûüůŮŪū","yŸÿýÝ","zŽžżŻźŹ"],d=[];return a.split("").forEach(function(e){c.every(function(c){if(c.indexOf(e)!==-1){if(d.indexOf(c)>-1)return!1;a=a.replace(new RegExp("["+c+"]","gm"+b),"["+c+"]"),d.push(c)}return!0})}),a}},{key:"createMergedBlanksRegExp",value:function(a){return a.replace(/[\s]+/gim,"[\\s]*")}},{key:"createAccuracyRegExp",value:function(a){var b=this,c=this.opt.accuracy,d="string"==typeof c?c:c.value,e="string"==typeof c?[]:c.limiters,f="";switch(e.forEach(function(a){f+="|"+b.escapeStr(a)}),d){case"partially":default:return"()("+a+")";case"complementary":return"()([^\\s"+f+"]*"+a+"[^\\s"+f+"]*)";case"exactly":return"(^|\\s"+f+")("+a+")(?=$|\\s"+f+")"}}},{key:"getSeparatedKeywords",value:function(a){var b=this,c=[];return a.forEach(function(a){b.opt.separateWordSearch?a.split(" ").forEach(function(a){a.trim()&&c.indexOf(a)===-1&&c.push(a)}):a.trim()&&c.indexOf(a)===-1&&c.push(a)}),{keywords:c.sort(function(a,b){return b.length-a.length}),length:c.length}}},{key:"getTextNodes",value:function(a){var b=this,c="",d=[];this.iterator.forEachNode(NodeFilter.SHOW_TEXT,function(a){d.push({start:c.length,end:(c+=a.textContent).length,node:a})},function(a){return b.matchesExclude(a.parentNode,!0)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},function(){a({value:c,nodes:d})})}},{key:"matchesExclude",value:function(a,b){var c=this.opt.exclude.concat(["script","style","title","head","html"]);return b&&(c=c.concat(["*[data-markjs='true']"])),d.matches(a,c)}},{key:"wrapRangeInTextNode",value:function(a,c,d){var e=this.opt.element?this.opt.element:"mark",f=a.splitText(c),g=f.splitText(d-c),h=b.createElement(e);return h.setAttribute("data-markjs","true"),this.opt.className&&h.setAttribute("class",this.opt.className),h.textContent=f.textContent,f.parentNode.replaceChild(h,f),g}},{key:"wrapRangeInMappedTextNode",value:function(a,b,c,d,e){var f=this;a.nodes.every(function(g,h){var i=a.nodes[h+1];if("undefined"==typeof i||i.start>b){var j=function(){var i=b-g.start,j=(c>g.end?g.end:c)-g.start;if(d(g.node)){g.node=f.wrapRangeInTextNode(g.node,i,j);var k=a.value.substr(0,g.start),l=a.value.substr(j+g.start);if(a.value=k+l,a.nodes.forEach(function(b,c){c>=h&&(a.nodes[c].start>0&&c!==h&&(a.nodes[c].start-=j),a.nodes[c].end-=j)}),c-=j,e(g.node.previousSibling,g.start),!(c>g.end))return{v:!1};b=g.end}}();if("object"===("undefined"==typeof j?"undefined":_typeof(j)))return j.v}return!0})}},{key:"wrapMatches",value:function(a,b,c,d,e){var f=this,g=0===b?0:b+1;this.getTextNodes(function(b){b.nodes.forEach(function(b){b=b.node;for(var e=void 0;null!==(e=a.exec(b.textContent))&&""!==e[g];)if(c(e[g],b)){var h=e.index;if(0!==g)for(var i=1;i<g;i++)h+=e[i].length;b=f.wrapRangeInTextNode(b,h,h+e[g].length),d(b.previousSibling),a.lastIndex=0}}),e()})}},{key:"wrapMatchesAcrossElements",value:function(a,b,c,d,e){var f=this,g=0===b?0:b+1;this.getTextNodes(function(b){for(var h=void 0;null!==(h=a.exec(b.value))&&""!==h[g];){var i=h.index;if(0!==g)for(var j=1;j<g;j++)i+=h[j].length;var k=i+h[g].length;f.wrapRangeInMappedTextNode(b,i,k,function(a){return c(h[g],a)},function(b,c){a.lastIndex=c,d(b)})}e()})}},{key:"unwrapMatches",value:function(a){for(var c=a.parentNode,d=b.createDocumentFragment();a.firstChild;)d.appendChild(a.removeChild(a.firstChild));c.replaceChild(d,a),c.normalize()}},{key:"markRegExp",value:function(a,b){var c=this;this.opt=b,this.log('Searching with expression "'+a+'"');var d=0,e="wrapMatches",f=function(a){d++,c.opt.each(a)};this.opt.acrossElements&&(e="wrapMatchesAcrossElements"),this[e](a,this.opt.ignoreGroups,function(a,b){return c.opt.filter(b,a,d)},f,function(){0===d&&c.opt.noMatch(a),c.opt.done(d)})}},{key:"mark",value:function(a,b){var c=this;this.opt=b;var d=0,e="wrapMatches",f=this.getSeparatedKeywords("string"==typeof a?[a]:a),g=f.keywords,h=f.length,i=this.opt.caseSensitive?"":"i",j=function a(b){var f=new RegExp(c.createRegExp(b),"gm"+i),j=0;c.log('Searching with expression "'+f+'"'),c[e](f,1,function(a,e){return c.opt.filter(e,b,d,j)},function(a){j++,d++,c.opt.each(a)},function(){0===j&&c.opt.noMatch(b),g[h-1]===b?c.opt.done(d):a(g[g.indexOf(b)+1])})};this.opt.acrossElements&&(e="wrapMatchesAcrossElements"),0===h?this.opt.done(d):j(g[0])}},{key:"unmark",value:function(a){var b=this;this.opt=a;var c=this.opt.element?this.opt.element:"*";c+="[data-markjs]",this.opt.className&&(c+="."+this.opt.className),this.log('Removal selector "'+c+'"'),this.iterator.forEachNode(NodeFilter.SHOW_ELEMENT,function(a){b.unwrapMatches(a)},function(a){var e=d.matches(a,c),f=b.matchesExclude(a,!1);return!e||f?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},this.opt.done)}},{key:"opt",set:function(b){this._opt=_extends({},{element:"",className:"",exclude:[],iframes:!1,separateWordSearch:!0,diacritics:!0,synonyms:{},accuracy:"partially",acrossElements:!1,caseSensitive:!1,ignoreJoiners:!1,ignoreGroups:0,each:function(){},noMatch:function(){},filter:function(){return!0},done:function(){},debug:!1,log:a.console},b)},get:function(){return this._opt}},{key:"iterator",get:function(){return this._iterator||(this._iterator=new d(this.ctx,this.opt.iframes,this.opt.exclude)),this._iterator}}]),c}(),d=function(){function a(b){var c=arguments.length<=1||void 0===arguments[1]||arguments[1],d=arguments.length<=2||void 0===arguments[2]?[]:arguments[2];_classCallCheck(this,a),this.ctx=b,this.iframes=c,this.exclude=d}return _createClass(a,[{key:"getContexts",value:function(){var a=void 0,b=[];return a="undefined"!=typeof this.ctx&&this.ctx?NodeList.prototype.isPrototypeOf(this.ctx)?Array.prototype.slice.call(this.ctx):Array.isArray(this.ctx)?this.ctx:[this.ctx]:[],a.forEach(function(a){var c=b.filter(function(b){return b.contains(a)}).length>0;b.indexOf(a)!==-1||c||b.push(a)}),b}},{key:"getIframeContents",value:function(a,b){var c=arguments.length<=2||void 0===arguments[2]?function(){}:arguments[2],d=void 0;try{var e=a.contentWindow;if(d=e.document,!e||!d)throw new Error("iframe inaccessible")}catch(a){c()}d&&b(d)}},{key:"onIframeReady",value:function(a,b,c){var d=this;try{!function(){var e=a.contentWindow,f="about:blank",g="complete",h=function(){var b=a.getAttribute("src").trim(),c=e.location.href;return c===f&&b!==f&&b},i=function(){var e=function e(){try{h()||(a.removeEventListener("load",e),d.getIframeContents(a,b,c))}catch(a){c()}};a.addEventListener("load",e)};e.document.readyState===g?h()?i():d.getIframeContents(a,b,c):i()}()}catch(a){c()}}},{key:"waitForIframes",value:function(a,b){var c=this,d=0;this.forEachIframe(a,function(){return!0},function(a){d++,c.waitForIframes(a.querySelector("html"),function(){--d||b()})},function(a){a||b()})}},{key:"forEachIframe",value:function(b,c,d){var e=this,f=arguments.length<=3||void 0===arguments[3]?function(){}:arguments[3],g=b.querySelectorAll("iframe"),h=g.length,i=0;g=Array.prototype.slice.call(g);var j=function(){--h<=0&&f(i)};h||j(),g.forEach(function(b){a.matches(b,e.exclude)?j():e.onIframeReady(b,function(a){c(b)&&(i++,d(a)),j()},j)})}},{key:"createIterator",value:function(a,c,d){return b.createNodeIterator(a,c,d,!1)}},{key:"createInstanceOnIframe",value:function(b){return new a(b.querySelector("html"),this.iframes)}},{key:"compareNodeIframe",value:function(a,b,c){var d=a.compareDocumentPosition(c),e=Node.DOCUMENT_POSITION_PRECEDING;if(d&e){if(null===b)return!0;var f=b.compareDocumentPosition(c),g=Node.DOCUMENT_POSITION_FOLLOWING;if(f&g)return!0}return!1}},{key:"getIteratorNode",value:function(a){var b=a.previousNode(),c=void 0;return c=null===b?a.nextNode():a.nextNode()&&a.nextNode(),{prevNode:b,node:c}}},{key:"checkIframeFilter",value:function(a,b,c,d){var e=!1,f=!1;return d.forEach(function(a,b){a.val===c&&(e=b,f=a.handled)}),this.compareNodeIframe(a,b,c)?(e!==!1||f?e===!1||f||(d[e].handled=!0):d.push({val:c,handled:!0}),!0):(e===!1&&d.push({val:c,handled:!1}),!1)}},{key:"handleOpenIframes",value:function(a,b,c,d){var e=this;a.forEach(function(a){a.handled||e.getIframeContents(a.val,function(a){e.createInstanceOnIframe(a).forEachNode(b,c,d)})})}},{key:"iterateThroughNodes",value:function(a,b,c,d,e){for(var f=this,g=this.createIterator(b,a,d),h=[],i=void 0,j=void 0,k=function(){var a=f.getIteratorNode(g);return j=a.prevNode,i=a.node};k();)this.iframes&&this.forEachIframe(b,function(a){return f.checkIframeFilter(i,j,a,h)},function(b){f.createInstanceOnIframe(b).forEachNode(a,c,d)}),c(i);this.iframes&&this.handleOpenIframes(h,a,c,d),e()}},{key:"forEachNode",value:function(a,b,c){var d=this,e=arguments.length<=3||void 0===arguments[3]?function(){}:arguments[3],f=this.getContexts(),g=f.length;g||e(),f.forEach(function(f){var h=function(){d.iterateThroughNodes(a,f,b,c,function(){--g<=0&&e()})};d.iframes?d.waitForIframes(f,h):h()})}}],[{key:"matches",value:function(a,b){var c="string"==typeof b?[b]:b,d=a.matches||a.matchesSelector||a.msMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.webkitMatchesSelector;if(d){var e=!1;return c.every(function(b){return!d.call(a,b)||(e=!0,!1)}),e}return!1}}]),a}();return a.Mark=function(a){var b=this,d=new c(a);return this.mark=function(a,c){return d.mark(a,c),b},this.markRegExp=function(a,c){return d.markRegExp(a,c),b},this.unmark=function(a){return d.unmark(a),b},this},a.Mark},window,document);
var markInstance=new Mark(document.querySelector("#wrapper")),options={element:"mark",className:"",exclude:[],separateWordSearch:!1,accuracy:"partially",diacritics:!0,synonyms:{},iframes:!1,iframesTimeout:5e3,acrossElements:!1,caseSensitive:!1,ignoreJoiners:!1,ignorePunctuation:[],wildcards:"disabled",each:function(e){},filter:function(e,a,n,r){return!0},noMatch:function(e){},done:function(e){},debug:!1,log:window.console};searchTerm&&-1===document.body.getAttribute("class").indexOf("search-page")&&markInstance.unmark().mark(searchTerm,options);
"use strict";function ebTruncateText(e,i){var r=e;return r.length>i&&(r=r.substring(0,i)+"…"),r}var ebSlideSupports=function(){return-1===navigator.userAgent.indexOf("Opera Mini")&&"querySelector"in document&&"addEventListener"in window&&"onhashchange"in window&&!!Array.prototype.forEach&&document.querySelectorAll(".slides")},ebSlidesMoveSummaryMeta=function(e){e.forEach(function(e){var i=e.querySelector(".summary"),r=i.querySelector(".caption"),t=i.querySelector(".figure-source"),n=document.createElement("div");n.classList.add("figure-summary-meta"),null!=r&&n.insertAdjacentHTML("beforeend",r.outerHTML),null!=t&&n.insertAdjacentHTML("beforeend",t.outerHTML),e.insertAdjacentHTML("beforeend",n.outerHTML),e.id=i.id,e.removeChild(i)})},ebSlidesBuildNav=function(e){e.forEach(function(e){var i=e.querySelectorAll(".figure"),r=i.length,t="";t+='<nav class="nav-slides',r>4&&(t+=" nav-slides-many",r>6&&(t+=" nav-slides-many-many")),t+='">',t+="<ol>",i.forEach(function(e){if(t+="<li>",t+='<a href="#'+e.id+'">',e.querySelector(".figure-images img")){var i=e.querySelector(".figure-images img").cloneNode();i.removeAttribute("srcset"),i.removeAttribute("sizes"),i.setAttribute("alt",""),t+=i.outerHTML}else{var r=e.querySelector(".figure-body .title").innerText;r=ebTruncateText(r,8),t+='<span class="slide-thumbnail-text">',t+=r,t+="</span>"}t+="</a>",t+="</li>"}),t+="</ol>",t+="</nav>",e.insertAdjacentHTML("afterbegin",t)})},ebResetSlides=function(e){e.forEach(function(e){e.querySelectorAll(".figure").forEach(function(e){e.classList.add("visuallyhidden")}),e.previousElementSibling.querySelectorAll(".nav-slides li").forEach(function(e){e.classList.remove("slide-current")})})},ebSlidesShowFirstInSlideline=function(e){e.querySelectorAll(".figure")[0].classList.remove("visuallyhidden")},ebSlidesShowFirst=function(e){e.forEach(function(e){ebSlidesShowFirstInSlideline(e)})},ebSlidesMarkNavUpToCurrent=function(e){var i=e.querySelectorAll(".nav-slides li"),r=!1;i.forEach(function(e){if(!r)return e.classList.contains("slide-current")?void(r=!0):void e.classList.add("slide-current")})},ebSlidesShow=function(e){if(!window.location.hash)return void ebSlidesShowFirst(e);var i=decodeURIComponent(window.location.hash.replace(":","\\:"));if(!isNaN(i[1]))return void ebSlidesShowFirst(e);e.forEach(function(e){if(!e.querySelector(i))return void ebSlidesShowFirstInSlideline(e);e.querySelector(i).classList.remove("visuallyhidden"),e.querySelectorAll(".nav-slides li").forEach(function(e){e.classList.remove("slide-current")});var r='.nav-slides [href="'+i+'"]',t=e.querySelector(r);t.setAttribute("tabindex",0),t.focus(),t.parentNode.classList.add("slide-current"),ebSlidesMarkNavUpToCurrent(e)})},ebSlidesKeyDown=function(){window.addEventListener("keydown",function(e){var i=e.key||e.which,r=e.target||e.srcElement;document.querySelector(".slides "+r.hash)&&("ArrowLeft"!==i&&37!==i&&"ArrowUp"!==i&&38!==i||!r.parentNode.previousElementSibling?"ArrowRight"!==i&&39!==i&&"ArrowDown"!==i&&"40"!==i||!r.parentNode.nextElementSibling||(e.preventDefault(),r.parentNode.nextElementSibling.querySelector("a").click()):(e.preventDefault(),r.parentNode.previousElementSibling.querySelector("a").click()))})},ebSlidesAlreadyShown=function(){document.querySelectorAll(".nav-slides a").forEach(function(e){e.addEventListener("click",function(e){document.querySelector(this.getAttribute("href")).classList.contains("visuallyhidden")||e.preventDefault()})})},ebSlides=function(){if(ebSlideSupports()){var e=document.querySelectorAll(".slides");ebSlidesMoveSummaryMeta(e),ebSlidesBuildNav(e),ebResetSlides(e),ebSlidesShow(e),ebSlidesAlreadyShown(),window.addEventListener("hashchange",function(){ebResetSlides(e),ebSlidesShow(e)}),ebSlidesKeyDown()}};ebSlides();
var ebLazyLoadImages=function(e){Array.prototype.forEach&&e.forEach(function(e){var t=e.previousElementSibling;e.previousElementSibling&&"noscript"===t.tagName.toLowerCase()&&t.parentNode.removeChild(e.previousElementSibling);var r=e.getAttribute("data-src");if(r&&(e.setAttribute("src",r),e.removeAttribute("data-src"),"srcset"in document.createElement("img"))){var a=e.getAttribute("data-srcset");e.setAttribute("srcset",a),e.removeAttribute("data-srcset")}})};if("querySelectorAll"in document){var thisIsNotAUnit=-1===document.querySelector("body").getAttribute("class").indexOf("chapter"),thisHasNoH2s=null===document.querySelector("#content h2"),thisIsEndmatter=-1!=document.querySelector("body").getAttribute("class").indexOf("endmatter"),thisIsALeibniz=-1!=document.querySelector("body").getAttribute("class").indexOf("leibniz");if(thisIsNotAUnit||thisHasNoH2s||thisIsEndmatter||thisIsALeibniz){var lazyImages=document.querySelectorAll("[data-srcset]");ebLazyLoadImages(lazyImages)}}if("querySelectorAll"in document){var chapterOpenerImages=document.querySelectorAll(".chapter-opener-image [data-srcset]");chapterOpenerImages&&ebLazyLoadImages(chapterOpenerImages)}
"use strict";var ebVideoInit=function(){return document.querySelectorAll(".videowrapper")},ebVideoHosts={youtube:"https://www.youtube.com/embed/",vimeo:"https://player.vimeo.com/video/"},ebGetVideoHost=function(e){var t,o=e.getAttribute("class");for(var r in ebVideoHosts)o.indexOf(r)>-1&&(t=r);return t},ebVideoMakeIframe=function(e,t){var o=ebVideoHosts[e],r=document.createElement("iframe");return r.setAttribute("frameborder",0),r.setAttribute("allowfullscreen",""),r.setAttribute("src",o+t),r},videoShow=function(e){if(ebVideoInit()){e.querySelectorAll(".video").forEach(function(e){var t=ebGetVideoHost(e),o=e.id,r=ebVideoMakeIframe(t,o),i=e.querySelector(".video-wrapper");e.classList.add("video-embedded"),i.innerHTML="",i.appendChild(r)})}};
"use strict";function ebAccordionInit(){return-1===navigator.userAgent.indexOf("Opera Mini")&&"querySelectorAll"in document&&"addEventListener"in window&&!!Array.prototype.forEach}function ebAccordionFirstSectionID(){var e=document.querySelector('[data-accordion-role="first-section"]').getAttribute("id");return e}function ebAccordionSetUpSections(e){if(document.querySelector(".subheadline")||document.querySelector("h2")){document.querySelector(".subheadline")?(document.querySelector(".subheadline").setAttribute("data-accordion-role","first-section"),document.querySelector(".subheadline").id="subheadline"):document.querySelector("h2").setAttribute("data-accordion-role","first-section"),ebAccordionFirstSectionID();var t=document.querySelector("#content");t.setAttribute("role","tablist"),e.forEach(function(e){var r=document.createElement("section");r.setAttribute("role","tabpanel"),r.setAttribute("aria-labelledby",e.id),r.setAttribute("data-accordion-container",e.id),t.insertBefore(r,e);var o=document.createElement("header");o.appendChild(e);var n=document.createElement("a");n.href="#"+e.id,n.innerHTML=e.innerHTML,e.innerHTML=n.outerHTML,e.setAttribute("role","tab"),r.appendChild(o);var c=document.createElement("div");c.setAttribute("data-container",!0),r.appendChild(c)})}}function ebAccordionFillSections(){var e=document.querySelectorAll("#content > *"),t=!1;e.forEach(function(e){if("tabpanel"===e.getAttribute("role"))return void(t=e);t&&t.querySelector("[data-container]").appendChild(e)})}function ebMoveThemeKeys(){var e=document.querySelectorAll(".theme-key");document.querySelectorAll(".theme-key a").forEach(function(e){e.parentNode.parentNode.parentNode.nextElementSibling.firstChild.firstChild.appendChild(e)}),e.forEach(function(e){e.parentNode.removeChild(e)})}function ebAccordionHideAll(){document.querySelectorAll('[role="tabpanel"]').forEach(function(e){e.querySelector('[role="tab"]').setAttribute("data-accordion","closed"),e.querySelector("[data-container]").setAttribute("aria-expanded","false")})}function ebAccordionHideAllExceptThisOne(e){document.querySelectorAll('[role="tabpanel"]').forEach(function(t){t.getAttribute("aria-labelledby")!==e&&(t.querySelector('[role="tab"]').setAttribute("data-accordion","closed"),t.querySelector("[data-container]").setAttribute("aria-expanded","false"))})}function ebAccordionCheckParent(e){if(!e)return!1;if(!e.parentNode)return!1;if("BODY"==e.tagName)return!1;var t=e.parentNode;return t.getAttribute("data-accordion-container")?t.getAttribute("data-accordion-container"):ebAccordionCheckParent(t)}function ebAccordionFindSection(e){return ebAccordionCheckParent(e)}function ebWhichTarget(e){var t;if(e){var e=decodeURIComponent(e);t=document.getElementById(e)}else{var r=window.location.hash.replace("#",""),r=decodeURIComponent(r);t=document.getElementById(r)}return t||!1}function ebAccordionShow(e){var t=ebWhichTarget(e);if(t){var r=ebAccordionFindSection(t);if(r){var o='[aria-labelledby="'+r+'"]',n=document.querySelector(o);n.querySelector('[role="tab"]').setAttribute("data-accordion","open");n.querySelector("[data-container]").setAttribute("aria-expanded","true");var c=n.querySelectorAll("[data-srcset]");ebLazyLoadImages(c);n.querySelectorAll(".slides").forEach(function(e){var t=e.querySelector(".figure img");t&&t.addEventListener("load",function(){t.height>t.width&&e.querySelector("nav").classList.add("nav-slides-portrait")})}),"function"==typeof videoShow&&videoShow(n)}}}function ebAccordionListenForAnchorClicks(){document.querySelectorAll("#content a").forEach(function(e){"_blank"!==e.target&&e.addEventListener("click",function(e){if(e.stopPropagation(),"noopener"!==this.getAttribute("rel")&&this.hasAttribute("href")){var t=this.getAttribute("href").replace(/.*#/,"");if("open"===this.parentNode.getAttribute("data-accordion"))return void ebAccordionHideAll();this.parentNode.getAttribute("data-accordion")||(t=ebAccordionFindSection(document.getElementById(t))),ebAccordionShow(t),ebAccordionHideAllExceptThisOne(t)}})})}function ebAccordionListenForHeadingClicks(){document.querySelectorAll("[data-accordion]").forEach(function(e){e.addEventListener("click",function(){this.querySelector("a").click()})})}function ebAccordionListenForNavClicks(){document.querySelectorAll("#nav [href]").forEach(function(e){e.addEventListener("click",function(){var e=document.getElementById(this.hash.replace(/.*#/,""));e&&"closed"===e.getAttribute("data-accordion")&&e.querySelector("a").click()})})}function ebAccordionListenForHashChange(){window.addEventListener("hashchange",function(){var e=window.location.hash,e=decodeURIComponent(e),t=document.getElementById(e.replace(/.*#/,"")),r=t.getBoundingClientRect(),o=r.top>=-r.height&&r.left>=-r.width&&r.bottom<=r.height+window.innerHeight&&r.right<=r.width+window.innerWidth,n=t.getAttribute("data-accordion");if(!o||n){if("closed"===n)return void t.querySelector("a").click();targetAccordionID=ebAccordionFindSection(t),ebAccordionShow(targetAccordionID),ebAccordionHideAllExceptThisOne(targetAccordionID)}})}function ebAccordify(){if(ebAccordionInit()){var e=document.querySelectorAll('#content h2, #content .subheadline, [data-accordion-role="first-section"]');if(e){var t=-1===document.querySelector("body").getAttribute("class").indexOf("chapter"),r=null===document.querySelector('#content h2, #content .subheadline, [data-accordion-role="first-section"]'),o=-1!==document.querySelector("body").getAttribute("class").indexOf("endmatter");if(!(t||r||o)){if(ebAccordionSetUpSections(e),ebAccordionFillSections(),ebMoveThemeKeys(),searchTerm){document.querySelectorAll("section[data-accordion-container]").forEach(function(e){var t=e.querySelectorAll("[data-markjs]"),r=t.length;if(r){var o=e.querySelector("header a");o.innerHTML="<mark>"+o.innerHTML+"</mark>";var n=document.createElement("p");n.innerHTML=1==r?r+" "+locales[pageLanguage].search["results-for-singular"]+' "<mark>'+searchTerm+'</mark>"':r+" "+locales[pageLanguage].search["results-for-plural"]+' "<mark>'+searchTerm+'</mark>"',e.querySelector("header").appendChild(n)}});var n=document.querySelectorAll("[data-markjs]"),c=n.length;if(c){var i=document.createElement("p");i.classList.add("search-results-summary"),i.innerHTML=1==c?c+" "+locales[pageLanguage].search["results-for-singular"]+' "<mark>'+searchTerm+'</mark>".':c+" "+locales[pageLanguage].search["results-for-plural"]+' "<mark>'+searchTerm+'</mark>".';var a=document.querySelector("h1");document.querySelector("#content").insertBefore(i,a.nextSibling),n[0].id="first-search-result",i.innerHTML+=' <a href="#first-search-result">'+locales[pageLanguage].search["jump-to-first"]+"</a>."}}if(!window.location.hash)return ebAccordionHideAllExceptThisOne(ebAccordionFirstSectionID()),void ebAccordionShow(ebAccordionFirstSectionID());ebAccordionHideAll(),ebAccordionShow()}}}}ebAccordify(),ebAccordionListenForAnchorClicks(),ebAccordionListenForHeadingClicks(),ebAccordionListenForNavClicks(),ebAccordionListenForHashChange();
"use strict";function ebTables(){-1===navigator.userAgent.indexOf("Opera Mini")&&"querySelectorAll"in document&&!!Array.prototype.forEach&&document.querySelectorAll(".figure table").forEach(function(e){var r=document.createElement("div");r.classList.add("table-wrapper"),e.parentNode.insertBefore(r,e),r.appendChild(e)})}ebTables();
var ebNewTabInit=function(){return-1===navigator.userAgent.indexOf("Opera Mini")&&"querySelector"in document&&!!Array.prototype.forEach},ebNewTabTargets='a[href*="//"], .figure-image-link',ebNewTab=function(){if(ebNewTabInit()){document.querySelectorAll(ebNewTabTargets).forEach(function(e){e.target="_blank",e.rel="noopener"})}};ebNewTab();
"use strict";var ebDefinitionsInit=function(){return-1===navigator.userAgent.indexOf("Opera Mini")&&"querySelector"in document&&"addEventListener"in window&&!!Array.prototype.forEach},ebDefinitionsSlugify=function(e){return e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},ebDefinitionsMoveDefinitions=function(){document.querySelectorAll(".definition-term").forEach(function(e){e.parentNode.classList.add("hidden-definition-list");var i=e.innerHTML,i=i.replace(/(<([^>]+)>)/gi,""),n=i.replace("’","'"),n=n.replace("‘","'");document.querySelector('[data-term="'+n+'"]')&&document.querySelectorAll('[data-term="'+n+'"]').forEach(function(n){var t=e.nextElementSibling.innerHTML,o=document.createElement("span");o.innerHTML='<span class="definition-hover-term">'+i+"</span> "+t,o.classList.add("visuallyhidden"),o.classList.add("definition-description-hover"),o.id="dd-"+ebDefinitionsSlugify(i),n.insertAdjacentElement("afterEnd",o);var s=document.createElement("button");s.classList.add("close"),s.innerHTML='<span class="visuallyhidden">close</span>',o.appendChild(s)})})},ebDefinitionsShowDescriptions=function(){document.querySelectorAll("[data-term]").forEach(function(e){var i=e.nextElementSibling;e.addEventListener("click",function(){i.classList.remove("visuallyhidden")})})},ebDefinitionsHideDescriptions=function(){document.querySelectorAll(".definition-description-hover").forEach(function(e){e.addEventListener("mouseleave",function(){setTimeout(function(){e.classList.add("visuallyhidden")},1e3)})})},ebDefinitionsHideDescriptionWithButton=function(){document.querySelectorAll(".definition-description-hover button.close").forEach(function(e){e.addEventListener("click",function(){e.parentNode.classList.add("visuallyhidden")})})},ebDefinitions=function(){ebDefinitionsInit()&&(ebDefinitionsMoveDefinitions(),ebDefinitionsShowDescriptions(),ebDefinitionsHideDescriptions(),ebDefinitionsHideDescriptionWithButton())};ebDefinitions();
"use strict";function ebReferences(){var e=-1===navigator.userAgent.indexOf("Opera Mini")&&"querySelector"in document&&"addEventListener"in window&&!!Array.prototype.forEach,t=document.querySelectorAll(".footnote");e&&0!==t.length&&t.forEach(function(e){var t=e.hash,n=e.hash.replace("#",""),i=t.replace(":","\\:"),a=document.querySelector(i),o=document.createElement("div");o.classList.add("footnote-detail"),o.classList.add("visuallyhidden"),o.id="inline-"+n;var r=e.parentNode,s=e.parentNode.parentNode;s.appendChild(o),o.innerHTML=a.innerHTML,r.addEventListener("mouseover",function(e){e.target.classList.contains("footnote")&&o.classList.remove("visuallyhidden")}),s.parentNode.classList.add("contains-footnote"),o.addEventListener("mouseleave",function(e){e.target===this&&setTimeout(function(){o.classList.add("visuallyhidden")},1e3)});var d=o.querySelector(".reversefootnote");d.innerText="",d.addEventListener("click",function(e){e.preventDefault(),o.classList.add("visuallyhidden")}),e.removeAttribute("href")})}ebReferences();
var ebMCQsInit=function(){return-1===navigator.userAgent.indexOf("Opera Mini")&&"querySelector"in document&&!!Array.prototype.forEach&&"addEventListener"in window&&document.querySelectorAll(".question")},ebMCQsFindNumberOfCorrectAnswers=function(e){var t=/\D/;return e.match(t).index},ebMCQsPositionOfCorrectAnswer=function(e){var t=/[aeiou]*/;return e.match(t)[0].length},ebMCQsDobfuscateQuestionCode=function(e){for(var t=ebMCQsFindNumberOfCorrectAnswers(e),r=e.length,n=e.substr(t,r),o=[],c=0;c<t;c++){var s=ebMCQsPositionOfCorrectAnswer(n);o.push(s),n=n.substr(2*s,n.length)}return o},ebMCQsGetCorrectAnswers=function(e){var t=e.getAttribute("data-question-code"),r=ebMCQsDobfuscateQuestionCode(t),n={};return e.querySelectorAll(".mcq-feedback li").forEach(function(e,t){n[t+1]=!1}),r.forEach(function(e){n[e]=!0}),n},ebMCQsMakeOptionCheckboxes=function(e){e.querySelectorAll(".mcq-options li").forEach(function(e,t){var r=document.createElement("input");r.setAttribute("type","checkbox"),r.setAttribute("data-index",t),e.innerHTML="<label>"+r.outerHTML+e.innerHTML+"</label>"})},ebMCQsAddButton=function(e){var t=document.createElement("button");t.innerHTML=locales[pageLanguage].questions["check-answers-button"],t.classList.add("check-answer-button");var r=e.querySelector(".mcq-feedback");e.insertBefore(t,r)},ebMCQsGetAllSelected=function(e){var t={};return e.querySelectorAll('[type="checkbox"]').forEach(function(e,r){t[r+1]=!1}),e.querySelectorAll('[type="checkbox"]:checked').forEach(function(e){var r=parseFloat(e.getAttribute("data-index"));t[r+1]=!0}),t},ebMCQsHideAllFeedback=function(e){e.querySelectorAll(".mcq-feedback li").forEach(function(e){e.classList.remove("mcq-feedback-show")})},ebMCQsShowSelectedOptions=function(e,t){e.querySelectorAll(".mcq-feedback li").forEach(function(e,r){t[r+1]&&e.classList.add("mcq-feedback-show")})},ebMCQsShowSelectedIncorrectOptions=function(e,t,r){e.querySelectorAll(".mcq-feedback li").forEach(function(e,n){t[n+1]&&t[n+1]!==r[n+1]&&e.classList.add("mcq-feedback-show")})},ebMCQsMarkSelectedOptions=function(){document.querySelectorAll(".mcq-options li").forEach(function(e){e.addEventListener("click",function(){this.querySelector('[type="checkbox"]:checked')?this.classList.add("selected"):this.classList.remove("selected")})})},ebMCQsGetAllCorrectAnswers=function(){var e={};return document.querySelectorAll(".question").forEach(function(t){var r=ebMCQsGetCorrectAnswers(t),n=t.getAttribute("data-question");e[n]=r}),e},ebMCQsExactlyRight=function(e,t){for(var r in t)if(t[r]!==e[r])return!1;return!0},ebMCQsNotAllTheCorrectAnswers=function(e,t){var r=0,n=0,o=0;for(var c in e)e[c]&&r++,e[c]&&t[c]&&n++,!e[c]&&t[c]&&o++;return n<r&&0===o},ebMCQsWordPressUserId=function(){var e=document.cookie.split("; "),t=e.find(function(e){return 0===e.indexOf("coreproject_sess")});return!!t&&decodeURIComponent(t).replace("coreproject_sess=","")},ebMCQsAddWordPressAccountButton=function(){var e=document.querySelector("#nav");if(e){var t=e.querySelector("h2"),r=document.createElement("a");r.innerText="Log in",r.href="/login/",r.classList.add("wordpress-link"),e.insertBefore(r,t),ebMCQsWordPressUserId()&&(r.innerText="My account",r.href="/account/")}},ebMCQsSendtoWordPress=function(e,t){var r=ebMCQsWordPressUserId();if(ebMCQsWordPressUserId()){var n={action:"quiz_score",book_id:1,quiz_id:e,user_id:r,score:t},o=[];for(var c in n)o.push(encodeURIComponent(c)+"="+encodeURIComponent(n[c]));var s=o.join("&"),i=new XMLHttpRequest;i.open("POST","/wp-admin/admin-ajax.php",!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.send(s)}},ebMCQsButtonClicks=function(){document.querySelectorAll(".check-answer-button").forEach(function(e){e.addEventListener("click",function(){var e=this.parentNode,t=e.getAttribute("data-question");e.getAttribute("data-question-code"),ebMCQsHideAllFeedback(e);var r=ebMCQsGetAllSelected(e),n=ebMCQsGetAllCorrectAnswers(),o=n[t];e.classList.remove("mcq-incorrect"),e.classList.remove("mcq-partially-correct"),e.classList.remove("mcq-correct");var c=0;ebMCQsExactlyRight(o,r)?(e.classList.add("mcq-correct"),ebMCQsShowSelectedOptions(e,r),c=1):ebMCQsNotAllTheCorrectAnswers(o,r)?(e.classList.add("mcq-partially-correct"),ebMCQsShowSelectedIncorrectOptions(e,r,o)):(e.classList.add("mcq-incorrect"),ebMCQsShowSelectedIncorrectOptions(e,r,o));var s=t.replace("question-","");ebMCQsSendtoWordPress(s,c)})})},ebMCQs=function(){if(ebMCQsInit()){ebMCQsAddWordPressAccountButton(),document.documentElement.classList.add("js-mcq");document.querySelectorAll(".question").forEach(function(e){ebMCQsMakeOptionCheckboxes(e),ebMCQsAddButton(e)}),ebMCQsMarkSelectedOptions(),ebMCQsButtonClicks()}};ebMCQs();
function toggleFindOutMore(e){if(e.target&&e.target.classList.contains("toggle")){var t=e.target.parentNode.parentNode.parentNode.querySelectorAll("h3 ~ *, h4 ~ *, h5 ~ *, h6 ~ *");if(e.target.classList.contains("closed")){e.target.classList.remove("closed"),e.target.classList.add("open");for(var o=0;o<t.length;o++)t[o].classList.remove("visuallyhidden")}else{e.target.classList.remove("open"),e.target.classList.add("closed");for(var o=0;o<t.length;o++)t[o].classList.add("visuallyhidden")}}}function addBoxToggle(e){var t=e.querySelector("h3 strong, h4 strong, h5 strong, h6 strong"),o=document.createElement("a");o.classList.add("toggle","closed"),t.insertAdjacentElement("beforeEnd",o),t.querySelector(".toggle").addEventListener("click",toggleFindOutMore,!0)}function processFindOutMoreBoxes(){var e=document.querySelectorAll(".find-out-more");for(i=0;i<e.length;i++){for(var t=e[i].querySelectorAll("h3 ~ *, h4 ~ *, h5 ~ *, h6 ~ *"),o=0;o<t.length;o++)t[o].classList.add("visuallyhidden");addBoxToggle(e[i])}}MathJax.Hub.Register.StartupHook("End",function(){processFindOutMoreBoxes()});


